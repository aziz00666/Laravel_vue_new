#!/usr/bin/env node

var fetchDiff = require('../lib/fetch-diff.js');
var httpMethods = require('../lib/http-methods.js');

var dir = process.argv.length > 2 ? dir = process.argv[2] : '.';

console.log('Preparing to submit diff for performance testing');
fetchDiff({dir: dir, remoteurl: 'https://github.com/facebook/react.git'}, function(diffString) {
  console.log('submitting diff: '+diffString);
  httpMethods.send(diffString, {}, function(err, data) {
    if (err) {
      console.error(err);
    } else {
      console.log("******************************************************************");
      console.log("* SUCCESS: Diff has been submitted to http://fburl.com/reactperf *");
      console.log("******************************************************************");
    }
  });

});
